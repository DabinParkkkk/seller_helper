<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Seller Helper</title>
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
            margin: 0;
            padding: 0;
            background: #f8f9fa;
            text-align: center;
        }

        /* ìƒë‹¨ Appbar */
        .appbar {
            width: 100%;
            height: 60px;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 999;
        }

        .appbar-logo img {
            height: 35px;
        }

        .appbar-menu {
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .appbar-menu a {
            font-size: 15px;
            text-decoration: none;
            color: #444;
            font-weight: 600;
        }

        /* ë©”ì¸ ì½˜í…ì¸  */
        .content-wrap {
            margin-top: 100px;
        }

        .logo-area img {
            height: 130px;
        }

        h1 {
            font-size: 32px;
            font-weight: 700;
            margin-top: 10px;
            margin-bottom: 10px;
            color: #222;
        }

        /* ì—…ë¡œë“œ ë°•ìŠ¤ */
        .upload-box {
            margin: 30px auto;
            background: white;
            width: 380px;
            padding: 40px 25px;
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.06);
        }

        select, input[type="file"], button {
            font-size: 15px;
            padding: 10px;
            border-radius: 10px;
            border: 1px solid #ccc;
            margin: 7px 0;
            width: 80%;
        }

        #uploadBtn {
            background: #f6d860;
            border: none;
            color: #333;
            font-weight: 600;
            cursor: pointer;
        }

        #uploadBtn:hover {
            background: #e6c850;
        }

        .sub-link {
            margin-top: 20px;
            font-size: 15px;
        }

        .sub-link a {
            color: #0077cc;
            font-weight: 600;
            text-decoration: underline;
        }
    </style>
</head>
<body>

    <!-- ìƒë‹¨ Appbar -->
    <div class="appbar">
        <div class="appbar-logo">
            <img src="/images/logo.png" alt="logo">
        </div>

        <div class="appbar-menu" id="menu-area">
            <!-- JSì—ì„œ ë¡œê·¸ì¸ ì—¬ë¶€ì— ë”°ë¼ ì±„ì›Œ ë„£ìŒ -->
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <div class="content-wrap">

        <div class="logo-area">
            <img src="/images/logo.png" alt="SellerHP ë¡œê³ ">
        </div>

        <h1>ìš´ì†¡ì¥ ì •ë¦¬ë¥¼ ë” ì‰½ê²Œ ë„ì™€ë“œë¦´ê²Œìš”</h1>

        <div class="upload-box">
            <label>ì‚¬ìš©í•˜ëŠ” íƒë°°ì‚¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</label><br>

            <select id="courier">
                <option value="hanjin">í•œì§„íƒë°°</option>
                <option value="cj">CJëŒ€í•œí†µìš´ (ì•„ì§ êµ¬í˜„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤)</option>
                <option value="custom">ì‚¬ìš©ì ì„¤ì •</option>
            </select>

            <br><br>

            <input type="file" id="fileInput" accept=".xlsx,.xls" />
            <button id="uploadBtn">ë³€í™˜í•˜ê¸°</button>

            <div id="status">ğŸ“‚ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”</div>
        </div>

        <div class="sub-link">
            ì¿ íŒ¡ ì‚¬ì´íŠ¸ë¡œ ëŒ€ëŸ‰ ìš´ì†¡ì¥ ë“±ë¡ì´ í•„ìš”í•˜ë‹¤ë©´  
            <a href="/register.html">ëˆŒëŸ¬ì£¼ì„¸ìš”</a>
        </div>
    </div>

    <!-- ë¡œê·¸ì¸ ìƒíƒœ í‘œì‹œ -->
    <script>
        function renderMenu() {
            const token = localStorage.getItem("token");
            const menu = document.getElementById("menu-area");

            if (token) {
                menu.innerHTML = `
                    <span style="color:#444; font-weight:600;">ë¡œê·¸ì¸ë¨</span>
                    <a href="#" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</a>
                `;
            } else {
                menu.innerHTML = `
                    <a href="/signup.html">íšŒì›ê°€ì…</a>
                    <a href="/login.html">ë¡œê·¸ì¸</a>
                `;
            }
        }

        function logout() {
            localStorage.removeItem("token");
            renderMenu();
        }

        window.onload = renderMenu;
    </script>

    <!-- ë³€í™˜ ê¸°ëŠ¥ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        document.getElementById("uploadBtn").addEventListener("click", async () => {
            const courier = document.getElementById("courier").value;
            const file = document.getElementById("fileInput").files[0];
            const status = document.getElementById("status");

            if (!file) {
                status.innerText = "âŒ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.";
                return;
            }

            status.innerText = "â³ ë³€í™˜ ì¤‘...";

            const formData = new FormData();
            formData.append("file", file);
            formData.append("type", courier);

            try {
                const res = await fetch("/excel/convert", {
                    method: "POST",
                    body: formData
                });

                if (!res.ok) {
                    status.innerText = "âŒ ë³€í™˜ ì‹¤íŒ¨ (ì„œë²„ ì˜¤ë¥˜)";
                    return;
                }

                const blob = await res.blob();
                const url = URL.createObjectURL(blob);

                const a = document.createElement("a");
                a.href = url;
                a.download = "converted.xlsx";
                a.click();

                URL.revokeObjectURL(url);

                status.innerText = "âœ… ë³€í™˜ ì„±ê³µ! ë‹¤ìš´ë¡œë“œ ì™„ë£Œ";

            } catch (e) {
                console.error(e);
                status.innerText = "âŒ ì˜¤ë¥˜ ë°œìƒ";
            }
        });
    </script>

</body>
</html>
